<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../../general/schematron/NictizTestScript.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<nts:component xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript">
    <nts:parameter name="scenarioset" value="0"/>
    <nts:parameter name="scenario" value="0"/>
    <nts:parameter name="scenarioDescription" value=""/>
    <nts:parameter name="scenarioPatient" value=""/>
    <nts:parameter name="scenarioDateT" value="no"/>
    <nts:parameter name="scenarioParams" value=""/>
    <nts:parameter name="returnCount" value=""/>
    <nts:parameter name="returnEntryCount" value=""/>
    <nts:parameter name="returnEntryBreakdown" value=""/>
    <id value="mp9-mtd-serve-{$scenarioset}-{$scenario}"/>
    <version value="r4-mp9-2.0.0"/>
    <name value="Medication Process 9 2.0.0  - MedicationAdministration (NL: MedicatieToeDiening) - Serve - Scenario {$scenarioset}.{$scenario}"/>
    <description value="Scenario {$scenarioset}.{$scenario} - {$scenarioDescription}"/>
    <nts:patientTokenFixture href="nl-core-Patient-mp9-{$scenarioPatient}-token.xml"/>
    <nts:includeDateT value="{$scenarioDateT}"/>
    
    <test id="Scenario-{$scenarioset}-{$scenario}">
        <name value="Scenario {$scenarioset}.{$scenario}"/>
        <description value="{$scenarioDescription}"/>
        <nts:include value="operation-search">
            <nts:with-parameter name="description" value="Test server to serve MedicationAdministration resource(s) for MedicationAdministration"/>
            <nts:with-parameter name="resource" value="MedicationDispense"/>
            <nts:with-parameter name="params" value="{$scenarioParams}"/>
        </nts:include>
        <nts:include value="assert-responseSearchBundleSuccess" scope="common"/>
        <nts:include value="assert-responseBundleContent-noMM"/>
        <nts:include value="assert-returnCount" scope="common">
            <nts:with-parameter name="resource" value="MedicationDispense"/>
            <nts:with-parameter name="count" value="{$returnCount}"/>
        </nts:include>
        <nts:include value="assert-returnEntryCountAtLeast" scope="project">
            <nts:with-parameter name="count" value="{$returnEntryCount}"/>
            <nts:with-parameter name="breakdown" value="{$returnEntryBreakdown}"/>
        </nts:include>
    </test>
</nts:component>