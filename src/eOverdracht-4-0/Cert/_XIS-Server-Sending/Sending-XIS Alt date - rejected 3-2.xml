<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../general/schematron/NictizTestScript.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<TestScript xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript" nts:scenario="server">
    
    <id value="Sending-xis-1.1-.1"/>
    <version value="stu3-2.0"/>
    <name value="TO DO "/>
    <description value="TO DO"/>
    
    <nts:patientTokenFixture href="eOverdracht-patient-XXX_Altenborg-token.xml"/>
    <nts:fixture id="task-update3-fixture" href="resources/resources-specific/eOverdracht-Task-volwassenen-IN-PROGRESS-ALTDATE-rej-flow.xml"/>
    <nts:includeDateT value="yes"/>
    
   <setup>
       <nts:include value="setup-initializeTask">
           <nts:with-parameter name="initial-task-fixture" value="resources/resources-specific/eOverdracht-Task-volwassenen-REQUESTED-ALTDATE-rej-flow-2.xml"/>
       </nts:include>
    </setup>
        
    <!-- Serve new Task with updated Advance Notice -->
    
    <test id="Scenario1.1-ServeTaskUpdate">
        <name value="Scenario1.1 - Serve Task with status requested with updated Adnvance Notice with alternate proposed date for patient XXX_Altenborg"/>
        <description value="Test XIS server to update a eOverdracht Task with status=on-hold. This Task is found using a search operation and the XIS server should return a Bundle with a single entry."/>
        <nts:include value="xis-scenario1-serveTask-requested"/>
    </test>
    
    <test id="Scenario1.1-RecieveTaskUpdate">
        <name value="Scenario1.1 - Handle update to eOverdracht Task"/>
        <description value="Test XIS server to handle an update to the eOverdracht Task with status 'accepted'. This will be an update operation where the original Task is sent, with only the status element changed."/>
        <nts:include value="test-handleTaskUpdate">
            <nts:with-parameter name="expected-status" value="accepted"/>
            <nts:with-parameter name="task-update-fixture" value="resources/resources-specific/eOverdracht-Task-volwassenen-ACCEPTED-ALTDATE-rej-flow.xml"/>
        </nts:include>
    </test>
    
    <test id="Scenario1.1-Update Task status in-progress">
        <name value="Scenario1.1 - Update Task with status in-progress for patient XXX_Altenborg"/>
        <description value="Test XIS server to update a eOverdracht Task with status=in-progress. This Task is found using a search operation and the XIS server should return a Bundle with a single entry."/>
        <nts:include value="xis-operation-updateTask-in-progress"/>
    </test>
    </TestScript>
