<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir http://hl7.org/fhir/STU3/testscript.xsd" xmlns="http://hl7.org/fhir">
  <id value="medmij-questionnaires-fhir3-0-1-reset-xis-1.1-3.1" />
    <url value="http://nictiz.nl/fhir/fhir3-0-1/TestScript/medmij-questionnaires-fhir3-0-1-reset-xis-1.1-3.1" />
  <name value="Nictiz MedMij Questionnaires - Reset Test Tasks for running XIS test 1.1-3.1 on Nictiz WildFHIR - only needed when running internal tests" />
  <status value="active" />
  <date value="2020-04-03" />
  <publisher value="Nictiz" />
  <contact>
    <name value="Nictiz" />
    <telecom>
      <system value="email" />
      <value value="kwalificatie@nictiz.nl" />
      <use value="work" />
    </telecom>
  </contact>
  <description value="Reset the Nictiz MedMij Questionnaires test Task resources to initial status (requested). This is needed when executing the XIS server test script for Questionnaires against an internal test server, since the Task resources in are modified during the process of XIS server testing." />
  <copyright value="Â© Nictiz 2020" />
  <fixture id="Task-fixture">
    <resource>
      <reference value="../_reference/resources/resources-specific/medmij-questionnaires-fhir3-0-1-vl-QuestionnaireProvisioningTask-Verkeulen-Intake-REQUESTED.xml" />
    </resource>
  </fixture>
  <!-- Fixture voor Bearer-token VERKEULEN -->
  <fixture id="patient1-token">
    <resource>
      <reference value="../_reference/medmij-questionnaires-fhir3-0-1-nl-core-patient-VERKEULEN-token.xml"/>
    </resource>
  </fixture>
  <variable>
    <name value="task-id" />
    <expression value="Task.id"/>
    <sourceId value="Task-fixture"/>
  </variable>
  <!-- Variabele voor datum-T -->
  <variable>
    <name value="T" />
    <defaultValue value="${CURRENTDATE}" />
    <description value="Date that data and queries are expected to be relative to." />
  </variable>
  <!-- Variabele voor Bearer-token VERKEULEN -->
  <variable>
    <name value="patient1-token-id"/>
    <expression value="Patient.id"/>
    <sourceId value="patient1-token"/>
  </variable>
  <test id="Step1-LoadTestResourceCreate">
    <name value="Step1-LoadTestResourceCreate" />
      <description value="Reset the Nictiz MedMij Questionnaires test Task resources to initial status, using the update (PUT) operation of the target FHIR server for use in MedMij Questionnaires qualification testing. The target XIS FHIR server is expected to support resource create via the update (PUT) operation for client assigned ids." />
    <action>
      <operation>
        <type>
          <system value="http://hl7.org/fhir/testscript-operation-codes" />
          <code value="updateCreate" />
        </type>
        <resource value="Task" />
        <accept value="xml" />
        <contentType value="xml" />
        <params value="/${task-id}" />
        <requestHeader>
          <field value="Authorization" />
          <value value="${patient1-token-id}" />
        </requestHeader>
        <sourceId value="Task-fixture" />
      </operation>
    </action>
    <action>
      <assert>
        <description value="Confirm that the returned HTTP status is 200(OK) or 201(Created)." />
        <operator value="in" />
        <responseCode value="200,201" />
      </assert>
    </action>
  </test>
</TestScript>